<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>TRAVELER - Free Travel Website Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js'></script>
    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    <style>
        .cart-product-image {
            width: 100px;
            /* Adjust as needed */
            height: auto;
            display: block;
        }

        body {
            background-color: #f4f7f9;
        }

        .payment-container {
            margin: 50px auto;
            text-align: center;
            position: relative;
        }

        .payment-container h1 {
            font-family: "Quicksand", sans-serif;
            margin-bottom: 40px;
        }

        .payment-container p {
            font-family: "Quicksand", sans-serif;
            color: #888;
            margin-top: 50px;
        }

        .payment-container .blank_space {
            height: 75px;
            display: block;
        }

        .payment-container .fieldRow {
            position: relative;
            display: inline-block;
            width: 450px;
            margin: 10px;
        }

        .payment-container .fieldRow.col2 {
            width: 210px;
            float: left;
        }

        .payment-container .fieldRow.last {
            float: right;
        }

        .payment-container .fieldRow.focus input {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0px 0px 2px 3px #edf2f6;
            background-color: #FFF;
        }

        .payment-container .fieldRow.focus input::-webkit-input-placeholder {
            color: #8d9dac;
        }

        .payment-container .fieldRow.focus input::-moz-input-placeholder {
            color: #8d9dac;
        }

        .payment-container .fieldRow.focus input::-ms-input-placeholder {
            color: #8d9dac;
        }

        .payment-container .fieldRow.focus input+label {
            left: -100px;
            opacity: 0;
        }

        .payment-container .fieldRow.focus input+label+i {
            opacity: 1;
        }

        .payment-container .fieldRow.active input {
            outline: none;
            border-color: #d2dbe2;
            box-shadow: none;
            background-color: #ecf1f5;
        }

        .payment-container .fieldRow.active input::-webkit-input-placeholder {
            color: #8d9dac;
        }

        .payment-container .fieldRow.active input::-moz-input-placeholder {
            color: #8d9dac;
        }

        .payment-container .fieldRow.active input::-ms-input-placeholder {
            color: #8d9dac;
        }

        .payment-container .fieldRow.active input+label {
            left: -100px;
            opacity: 0;
        }

        .payment-container .fieldRow.active input+label+i {
            opacity: 1;
        }

        .payment-container .fieldRow.active .iconCheck {
            color: #98a7b4 !important;
        }

        .payment-container .fieldRow.credit_card {
            transition: all 0.35s ease;
        }

        .payment-container .fieldRow.credit_card.zoomOn {
            transform: scale(2);
            z-index: 999;
        }

        .payment-container .fieldRow.credit_card.zoomOn .zoomBtn {
            display: none;
        }

        .payment-container .fieldRow.credit_card.zoomOn .closeBtn {
            display: block;
        }

        .payment-container input {
            display: inline-block;
            padding: 8px 50px;
            border-radius: 4px;
            border: solid 2px #d2dbe2;
            height: 55px;
            box-sizing: border-box;
            width: 100%;
            font-family: "Quicksand", sans-serif;
            font-size: 18px;
            transition: all 0.3s ease-in-out;
            color: #000;
        }

        .payment-container input.credit_card_number {
            padding-right: 100px;
        }

        .payment-container input+label {
            position: absolute;
            display: inline-block;
            top: 15px;
            left: 20px;
            color: #8d9dac;
            font-family: "Quicksand", sans-serif;
            font-size: 14px;
            font-size: 18px;
            opacity: 1;
            transition: all 0.6s ease;
        }

        .payment-container input::-webkit-input-placeholder {
            color: #FFF;
        }

        .payment-container input::-moz-input-placeholder {
            color: #FFF;
        }

        .payment-container input::-ms-input-placeholder {
            color: #FFF;
        }

        .payment-container i {
            position: absolute;
            left: 20px;
            top: 17px;
            opacity: 0;
            color: #8d9dac;
            font-size: 21px;
        }

        .payment-container #iconCC {
            position: initial;
            left: 0;
            opacity: 1;
            color: #999;
            width: 30px;
            display: inline-block;
        }

        .payment-container .closeBtn {
            position: absolute;
            top: 11px;
            right: 10px;
            padding: 8px 10px;
            background-color: #d2dbe2;
            color: #888;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.7s ease;
            display: none;
        }

        .payment-container .closeBtn i {
            position: relative;
            left: 0;
            top: 0;
            color: #333;
            opacity: 1;
            font-size: 18px;
        }

        .payment-container .closeBtn:hover {
            background-color: #888;
            color: #FFF;
            cursor: pointer;
        }

        .payment-container .zoomBtn {
            position: absolute;
            top: 11px;
            right: 10px;
            padding: 8px 10px;
            background-color: #d2dbe2;
            color: #888;
            border-radius: 4px;
            font-family: "Quicksand", sans-serif;
            font-size: 14px;
            transition: all 0.7s ease;
        }

        .payment-container .zoomBtn:hover {
            background-color: #888;
            color: #FFF;
            cursor: pointer;
        }

        .payment-container .zoomBtn:hover:after,
        .payment-container .zoomBtn:hover:before {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .payment-container .zoomBtn:before {
            content: "Enlarge the number to better control";
            width: 300px;
            height: 20px;
            padding: 5px 0;
            background-color: #888;
            display: block;
            position: absolute;
            z-index: 1;
            top: -50px;
            visibility: hidden;
            right: 0px;
            border-radius: 4px;
            color: #FFF;
            opacity: 0;
            transition: all 0.7s ease 0.2s;
            transform: translateY(50px);
        }

        .payment-container .zoomBtn:after {
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 15px 20px 0 20px;
            border-color: #888888 transparent transparent transparent;
            content: "";
            top: -21px;
            right: 12px;
            position: absolute;
            visibility: hidden;
            opacity: 0;
            transition: all 0.7s ease 0.2s;
            transform: translateY(50px);
        }

        .payment-container .iconCheck {
            position: absolute;
            right: 20px;
            left: auto;
            top: 17px;
            opacity: 1;
            display: none;
        }

        .payment-container #iconWrong {
            color: #ea4949;
        }

        .payment-container #iconPassed {
            color: #73ba4b;
        }

        button[type=submit] {
            width: 450px;
            margin: 20px 0;
            background: transparent;
            border: none;
            background: var(--primary);
            color: #FFF;
            padding: 15px;
            border-radius: 4px;
            font-family: "Quicksand", sans-serif;
            font-size: 18px;
            transition: all 0.35s ease;
        }

        button[type=submit]:hover {
            cursor: pointer;
            background: #87D37C;
        }

        .overlay {
            position: fixed;
            background: #FFF;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            bottom: 0;
            margin: auto;
            z-index: 998;
            opacity: 0.6;
            display: none;
        }

        .overlay.open {
            display: block;
        }

        i.checkmark {
            color: #9ABC66;
            font-size: 100px;
            line-height: 200px;
            margin-left: -15px;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translate(-50%);
        }
        .receive-card {
            text-align: center;
        }
        .receive-card h1{
            color: var(--success);
        }
        .receive-card p{
            font-weight: 1000;
        }
    </style>
</head>

<body>
    <!-- Topbar Start -->
    <div id="header-container"></div>
    <!-- Topbar End -->


    <!-- Header Start -->
    <div class="container-fluid page-header">
        <div class="container">
            <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 400px">
                <h3 class="display-4 text-white text-uppercase">Payment</h3>
                <div class="d-inline-flex text-white">
                    <p class="m-0 text-uppercase"><a class="text-white" href="">Home</a></p>
                    <i class="fa fa-angle-double-right pt-1 px-3"></i>
                    <p class="m-0 text-uppercase">Payment</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Header End -->

    <!-- Payment -->
    <div class="payment-container m-4">

        <h1>Payment form</h1>
        <div class="row align-items-center">
            <div class="col-12 col-lg-6">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button" style="background-color: var(--primary);" type="button"
                                data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true"
                                aria-controls="collapseOne">
                                Payment Breakdown
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                            data-bs-parent="#accordionExample">
                            <div class="accordion-body" style="width:100%;overflow:scroll;">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Transaction ID</th>
                                            <th scope="col">Package Name</th>
                                            <th scope="col">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pay-list">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-12 col-lg-6">
                <span class="fieldRow">
                    <input id="name" type="name" placeholder="" />
                    <label for="name">Full name</label>
                    <i for="name" class="fa fa-user"></i>
                </span>

                <span class="fieldRow">
                    <input id="cc" class="credit_card_number" type="text" placeholder="" />
                    <label for="cc">Credit card number</label>
                    <i for="cc" class="fa fa-credit-card"></i>
                </span>

                <span class="fieldRow">
                    <input id="cvv" type="text" placeholder="XXX" />
                    <label for="cvv">CVV</label>
                    <i for="cvv" class="fa fa-lock"></i>
                </span>

                <span class="fieldRow">
                    <input id="date" type="text" placeholder="mm/yy" />
                    <label for="date">Date</label>
                    <i for="date" class="fa  fa-calendar"></i>
                </span>

                <button type="submit" id="pay-now">PAY NOW</button>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="receive-card">
                        <div
                            style="border-radius:200px; height:200px; width:200px; background: #F8FAF5; margin:0 auto;position:relative;">
                            <i class="checkmark">✓</i>
                        </div>
                        <h1>Success</h1>
                        <p>We received your purchase request;<br /> we'll be in touch shortly! <br>You will redirect to
                            Home Page shortly</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal End -->
    <script>
        //pay-list
         var selectedProducts = [];
        $(document).ready(function () {
            var total_price = 0;
            var storedData = localStorage.getItem('selectedProducts');
            if (!storedData) {
                $("#pay-list").html(`
                    <tr>
                        <td colspan=4>No Data Can be Display.</td>
                    </tr>
                `)
                return
            }
            selectedProducts = JSON.parse(storedData);
            for (var i = 0; i < selectedProducts.length; i++) {
                var title = selectedProducts[i].title;
                var quantity = selectedProducts[i].quantity;
                var price = selectedProducts[i].price;

                var row = $('<tr></tr>');

                var transactionIdCell = $('<td style="vertical-align: middle;"></td>').text(i + 1);
                row.append(transactionIdCell);

                var packageNameCell = $('<td></td>');

                var packageDiv = $('<div style="display: flex;align-items: center;justify-content: flex-start; "></div>');
                var randomImageIndex = Math.floor(Math.random() * 6) + 1;
                var packageImage = $('<img>').attr('src', 'img/destination-' + randomImageIndex + '.jpg').attr('alt', 'Package one').addClass('cart-product-image');
                packageDiv.append(packageImage);

                var packageTitleSpan = $('<span></span>').text(title);
                packageDiv.append(packageTitleSpan);
                packageNameCell.append(packageDiv);
                row.append(packageNameCell);

                var amountCell = $('<td style="vertical-align: middle;"></td>').html(`${price}  x  ${quantity}<BR>=HK$${price * quantity}`);
                total_price += parseInt(price * quantity);
                row.append(amountCell);

                $("#pay-list").append(row);
            }
            // Add the total price row with colspan
            var totalRow = $('<tr></tr>');
            var totalCell = $('<td></td>').attr('colspan', '3').css('text-align', 'right').html(`Total Price: <strong style="font-size: x-large;">HK$${total_price}</strong>`);
            totalRow.append(totalCell);
            $("#pay-list").append(totalRow);
        });

        function validateCreditCard() {
            var ccInput = document.getElementById('cc');
            var cvvInput = document.getElementById('cvv');
            var dateInput = document.getElementById('date');

            var ccNumber = ccInput.value.trim();
            var cvv = cvvInput.value.trim();
            var expirationDate = dateInput.value.trim();

            // Check if any field is empty
            if (ccNumber === '' || cvv === '' || expirationDate === '') {
                toastbar('Please fill in all fields', 'red');
                return false;
            }

            // Validate CVV
            if (!/^\d{3}$/.test(cvv)) {
                toastbar('Invalid CVV', 'red');
                cvvInput.focus();
                return false;
            }

            // Validate expiration date
            if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expirationDate)) {
                toastbar('Invalid expiration date', 'red');
                dateInput.focus();
                return false;
            }

            return true;
        }

        // Event listener for form submission
        document.getElementById('pay-now').addEventListener('click', function (event) {
                event.preventDefault();
                if (validateCreditCard()) {
                    var selectedProducts = JSON.parse(localStorage.getItem('selectedProducts'));

                    // Get the existing payment history from localStorage
                    var paymentHistory = JSON.parse(localStorage.getItem('history_payment')) || [];

                    var timestamp = new Date().getTime();

                    // Create a new payment object with the products and timestamp
                    var payment = {
                        products: selectedProducts,
                        timestamp: timestamp
                    };

                    // Add the new payment to the payment history
                    paymentHistory.push(payment);

                    // Store the updated payment history in localStorage
                    localStorage.setItem('history_payment', JSON.stringify(paymentHistory));

                    // Remove the old selectedProducts from localStorage
                    localStorage.removeItem('selectedProducts');

                    $('#staticBackdrop').modal('show');
                    $('#staticBackdrop').on('hide.bs.modal', function (e) {
                        e.preventDefault();
                    });
                    setTimeout(function () {
                        window.location.href = 'index.html';
                    }, 2000);
                }
            });

        var $field = $('input'),
            $overlay = $('.overlay');

        $field.on('focus', function () {
            $(this).parent().addClass('focus');
            $(this).parent().removeClass('active');
        })

        $field.on('blur', function () {
            $(this).parent().removeClass('focus');

            if ($(this).val() !== "") {
                $(this).parent().addClass('active');
            } else {
                $(this).parent().removeClass('active');
            }
        });

        // Setup Cleave.js
        var cleaveCreditCard = new Cleave('.credit_card_number', {
            creditCard: true,
            onCreditCardTypeChanged: function (type) {
                if (selectedCardIcon) {
                    DOM.removeClass(selectedCardIcon, 'active');
                }

                selectedCardIcon = DOM.select('.icon-' + type);

                if (selectedCardIcon) {
                    DOM.addClass(selectedCardIcon, 'active');
                }
            }
        });
    </script>

    <!-- Payment end -->

    <!-- Footer Start -->
    <div id="footer-container"></div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>